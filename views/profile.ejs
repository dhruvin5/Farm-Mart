<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">    
    <link rel="stylesheet" href="../../stylesheets/style.css">
    <link rel="stylesheet" href="../stylesheets/cart1.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js" integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js" integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG" crossorigin="anonymous"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Fredoka+One&family=Kanit:wght@300&display=swap" rel="stylesheet">  
    <title>Profile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <style type="text/css">
      body {
        margin: 0;
       
        color: hsl(223, 13%, 21%);
        background: #f5f6fa;
        position: relative;
        height: 100%;
      }
      .account-settings .user-profile {
        margin: 0 0 1rem 0;
        padding-bottom: 1rem;
        text-align: center;
      }
      .account-settings .user-profile .user-avatar {
        margin: 0 0 1rem 0;
      }
      .account-settings .user-profile .user-avatar img {
        width: 170px;
        height: 170px;
        margin-top: 30px;
        -webkit-border-radius: 100px;
        -moz-border-radius: 100px;
        border-radius: 100px;
      }
      .account-settings .user-profile h5.user-name {
        margin-top: 30px ;
        font-size: xx-large;
      }
      .account-settings .user-profile h6.user-email {
        margin: 0;
        font-size: small;
        font-weight: 300;
        color: #9fa8b9;
      }
      .account-settings .about {
        
        margin: 2rem 0 0 0;
        text-align: center;
      }
      .account-settings .about h5 {
        text-decoration: underline green;
        margin: 0 0 15px 0;
        color: green;
      }
      .account-settings .about p {
        font-size: 0.9rem;
      }
      h3 {
        color: green;
      }
      .card {
        box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;
        background: #ffffff;
        -webkit-border-radius: 5px;
        -moz-border-radius: 5px;
        border-radius: 5px;
        border: 0;
        margin-bottom: 1rem;
      }
      .scrollable {
        overflow-y: auto;
        width: 100%;
        height: 400px;
      }
      p {
        font-size: 17px;
        font-weight: 400;
        line-height: 20px;
        color: #666666;
      }
      p.small {
        font-size: 14px;
      }

      .card2 {
        min-width: 720px;
        height: 110px;
        display: block;
        top: 0px;
        position: relative;
        background-color: #f2f8f9;
        border-radius: 4px;
        padding: 32px 24px;
        margin-top: 20px;
        text-decoration: none;
        z-index: 0;
        overflow: hidden;
        border: 1px solid #f2f8f9;
      }
      .card2:hover {
        transition: all 0.2s ease-out;
        box-shadow: 0px 4px 8px rgba(38, 38, 38, 0.2);
        top: -4px;
        border: 1px solid #cccccc;
        background-color: white;
      }
      .card2:before {
        content: "";
        position: absolute;
        z-index: -1;
        top: -16px;
        right: -16px;
        background: #00838d;
        height: 32px;
        width: 32px;
        border-radius: 32px;
        transform: scale(2);
        transform-origin: 50% 50%;
        transition: transform 0.15s ease-out;
      }
      .card2:hover:before {
        transform: scale(2.15);
      }
    </style>
  </head>
  <body>
    <nav class="topnav navbar navbar-expand-lg navbar-dark">
      <div class="container-fluid ms-5">
        <a class="navbar-brand logo nav-head" href="/">FARM-MART</a>
        <button class="navbar-toggler" type="button" style="background-color: black;" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
          <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
              <div class="navbar-nav ms-auto d-flex flex-row" style="transition: none;">
                <div class="d-flex flex-row mt-1">
                <a class="nav-link px-3" href="/">Home</a>
                <a class="nav-link px-3" href="/products">Grocery Menu</a>
              
                <a class="nav-link px-3" href="/blog">Blog</a>
                <a class="nav-link px-3" href="/contact">Contact us</a>
              </div>
                <% if(currentUser){ %> 
                  <a class="nav-link px-3 mt-1" href="/logout">Logout</a>
                  <div class="d-flex flex-row">
                    <div>
                    <a class="nav-link px-3" href="/cart"><i class="fa fa-2x fa-shopping-bag"></i></a>
                  </div>
                  
                  </div>
               
                <% } else { %>
                  <div class="mt-1">
                  <a class="nav-link px-3" href="/login">Login</a>
                </div>
                  
                  <% } %>
                 
              </div>
          </div>
      </div>
    </nav>
    <section class="intro1 d-flex flex-column justify-content-center  align-items-center mb-5">
      <h2 class="intro-index">Profile</h2>
      <h7 class="intro-index-2">Home-Profile</h7>
    </section>
    <div class="">
      <div style="width:1199px;margin-left:21px">
        <%- include('./partials/flash')%>
      </div>
      <div class="row"> 
        
        <div class="" style="height:550px;width: 250px; margin-left:20px;">
          <div class="card" style="height:490px;">
            <div class="card-body">
              <div class="account-settings">
                <div class="user-profile">
                  <div class="user-avatar">
                    <img
                      src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTpzmRU6OsrtwQPoMnRYGNW0uxlzh5-dXKDRQ&usqp=CAU"
                    />
                  </div>
                  
                  <h5 class="user-name"><%= currentUser.username  %> </h5>
                  <h6 class="user-email"><%= currentUser.email  %> </h6>
                </div>
                <div class="about">
                  <h5>About</h5>
                  <p>Total Orders: <%= orders.length  %> </p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="" style="height: 550px;width:999px;">
          <div class="card p-3" style="width: 100%;">
            <div class="">
              <div class="row">
                <div class=" ms-3 mb-3">
                  
                  <h3><u>Your Orders</u></h3>
                </div>
              </div>
              <div class="row">
                <div class="">
                  <div class="scrollable row d-flex ms-2">
                    <% for(i=0; i<orders.length; i++){ %> 
                    <div class="card" style="box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px; height:350px;width:280px;margin-right:18px;">
                      <div class="d-flex flex-row justify-content-between mb-3 mt-3">
                        <div>
                          <div>
                            <h4 style="font-size:21px;"><b>Order #<%= orders[i].orderNum%> </b></h4>
                          </div>
                          <div class="text-muted">
                          <% var date = orders[i].date.toDateString()%>
                          <h6 style="font-size: 16px;"><%= date%></h6>
                        </div>
                        </div>
                        <div>
                            <img
                              style="object-fit: contain; height:60px;width: 70px;border-radius: 50%;" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSuvaSJMeNKUym_PeAM9G_ND1aqIfiWBECqdw&usqp=CAU"
                            />
                         
                        </div>
                      </div>
                     
                      <div style="height:195px;overflow-y:auto;border-bottom: 2px #f4f1e3 solid;">
                      <% for(j =0 ; j<orders[i].carts.length; j++) {%> 
                                              
                        <div class="d-flex flex-row">
                          <div style="margin-right:38px ;">
                            <img style="object-fit: cover; height:60px;width:60px;border-radius:50%;" src="<%=orders[i].carts[j].imagepath%>" alt="">
                          </div>
                          <div class="d-flex flex-column w-100 me-2">
                            <div class="">
                               <h5 style="font-size: 17px;"><b><%= orders[i].carts[j].productName %></b></h5>
                         
                            </div>
                            <div class="flex-row d-flex justify-content-between">
                              <div class="">

                                <h5 style="font-size: 17px;"><b> &#8377 <%= orders[i].carts[j].productPrice %> </b></h5>
                               
                              </div>
                              <div>
                                <h5 style="font-size: 17px;"><b>  Qty : <%= orders[i].carts[j].quantity %>  </b></h5>

                             
                            </div>
                        </div>
                        <hr>
                        </div>
                        </div>
                      <% } %> 
                           
                  </div>
                 
                  <div class="d-flex flex-row justify-content-between ms-2 mt-2">
                    <div class="p-1">
                      <h4 style="color: black;"><b>&#8377 <% var total = orders[i].total * (1-(orders[i].discount /100)) %> <%= total %></b></h4>
                    </div>
                    <div class="p-2" id="cancel-<%=i%>" style="display: none;">
                      <form action="/cancelOrder?_method=DELETE" method="POST">
                        <input type="text" style="display: none;" value="<%= orders[i]._id %>" name="orders">
                      <button class="btn"><h6 style="text-align: center;font-size: 19px;color: rgb(192, 23, 23);">&#10007 Cancel</h6></button>
                    </form>
                    </div>
                    <div class="p-2" id="completed-<%=i%>">
                      <h6 style="text-align: center;font-size: 19px;color: rgb(97, 158, 35);">&#10003 Delivered</h6>
                    </div>
                    </div>
                    
                    </div>
                 
                  <% } %> 
                   
                    <!-- <div class="card border border-secondary" id="inner-card">
                      <div class="card-body">
                        <h5 class="card-title">Card title</h5>
                      </div>
                    </div> -->
              
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <div class="footer">
      <div class="column">
      <ul>
      <li class="title">FARM-MART</li>
      <li>Connects Mumbai with organic farmers across Maharashtra! <br>You will now be able to buy fresh, organically certified, fruits and vegetables directly from farmers.</li>
      </ul>
      </div>
      
      <div class="column">
      <ul>
      <li class="title">OTHER LINKS</li>
      <li><a href="/terms">Terms & Conditions</a></li>
      <li><a href="/privacy">Privacy Policy</a></li>
      <li><a href="/cookies">Cookie Policy</a></li>
      </ul>
      </div>
      
      <div class="column">
      <ul>
      <li class="title">SHORT CUT</li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/products">Grocery Menu</a></li>
      <li><a href="/">Home</a></li>
      </ul>
      </div>
      
      <div class="column">
      <ul>
        <li>Want to sell your farm products?</li>
      <li class="title">CONTACT US</li>
      <li>
      <a href="/contact" title="Address,State,Country,Pincode"><i class="fa fa-map-marker"></i></a>
      <a href="/contact"><i class="fa fa-phone"></i></a>
      <a href="/contact"><i class="fa fa-envelope"></i></a>
      </li>
      </ul>
      </div>
      </div>
      </footer>
      
    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script type="text/javascript"></script>
    <script>
      const orders1 = <%-JSON.stringify(orders)%>
    </script>
     <script src="../../javascripts/profile.js"></script>
  </body>
</html>
